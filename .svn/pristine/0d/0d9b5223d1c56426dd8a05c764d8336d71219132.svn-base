package com.ekenya.echama.model

import androidx.room.Entity
import androidx.room.Ignore
import androidx.room.PrimaryKey
import com.ekenya.echama.inc.AppInfo
import com.squareup.moshi.Json
import com.squareup.moshi.JsonAdapter
import com.squareup.moshi.JsonClass
import com.squareup.moshi.Types

@JsonClass(generateAdapter = true)
@Entity(tableName = "mygroup")
data class Group(
    @PrimaryKey   var groupid: Int
){
    var groupname: String = ""
    var groupsize: Int = 0
    var description: String? = ""
    var location: String = ""
    var activemembership: Boolean = false
    var title: String? = null
    var createdby: String? = null
    var createdon: String? = null
    var size: Int? = null
    var totalinvites: Int? = null
    var walletbalance: Double? = null
    var totalcontributions: Double? = null
    var currency: String = "Ksh"
    var groupfilesJson: String? = ""
        get(){
            val type = Types.newParameterizedType(MutableList::class.java, Gfiles::class.java)
            val adapterRegion: JsonAdapter<List<Gfiles>> = AppInfo.moshi.adapter(type)
            return adapterRegion.toJson(groupfiles)!!
        }
    @Ignore
    var groupfiles: List<Gfiles>? = null

    var invitesPhonenumbers: String = ""
          get(){
              val type = Types.newParameterizedType(MutableList::class.java, String::class.java)
              val adapterRegion: JsonAdapter<List<String>> = AppInfo.moshi.adapter(type)
              return adapterRegion.toJson(invitesPhoneNoAr)!!
          }
    @Ignore
    @Json(name = "invites_phonenumbers")
    var invitesPhoneNoAr: List<String>? = null

    fun getFormattedCurrency():String{
        if(currency.isEmpty()){
            return "Ksh"
        }
        return currency
    }

    fun fromJson(groupJson:String):Group {
        val adapterRegion: JsonAdapter<Group> = AppInfo.moshi.adapter(Group::class.java)
        adapterRegion.fromJson(groupJson)?.let {
            return it
        }
        return Group(0)
    }

    fun toJson():String{
        val adapterRegion: JsonAdapter<Group> = AppInfo.moshi.adapter(Group::class.java)
        return adapterRegion.toJson(this)
    }



}
 class Gfiles(var filename:String)


@JsonClass(generateAdapter = true)
@Entity(tableName = "group_account")
data class GroupAccount(
    @PrimaryKey   var accountid: Int
){
       var accountname: String = ""
       var accountnumber: String = ""
       var accounttypeid: String = ""
       var groupid: String = ""

}